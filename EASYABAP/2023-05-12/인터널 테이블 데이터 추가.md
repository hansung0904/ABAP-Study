# 인터널 테이블 데이터 추가
## 1 Insert 구문
### 1.1 Table Key를 이용해서 한 라인 추가

한 라인을 삽입하려면 다음 구문을 사용한다. Key 값을 이용해서 인터널 테이블에 라인을 추가한다.
```ABAP
INSERT line INTO TABLE itab
```
INSERT가 성공하면 시스템 변수 SY-SUBRC에 0이 저장된다. <br>

인터널 테이블에 UNIQUE KEY 값을 가지는 경우라면, INSERT 구문 수행 시 같은 Key 값이 존재하면 <br>
SY-SUBRC에 4 값을 반환하고 덤프 에러는 발생하지 않는다. <br>

### 1.2 Table Key를 이용해서 여러 라인 추가
INSERT 구문을 이용해서 여러 라인을 삽입할 수도 있다. 단 itab1 과 itab2 테이블은 같은 <br> Line Type 이어야 한다.

```ABAP
INSERT lines OF itab1 [FROM n1] [TO n2] INTO TABLE itab2.
```

### 1.3 Index를 이용해서 한 라인 추가
Index 구문을 이용하면 Index 값 위치에 라인을 삽입할 수 있음. <br>
이때는 Hashed Type의 인터널 테이블에는 사용할 수 없음. <br>
성공하게 되면, SY-SUBRC 변수는 0을 RETURN <br>
SY-TABIX 변수는 Index 값을 반환.
```ABAP
INSERT line INTO itab [Index idx].
```

### 1.4 인터널 테이블 타입에 따른 INSERT 효과
||||
|------|---|---|
|• Standard Table|데이터는 인터널 테이블의 마지막 위치에 추가된다.<br> APPEND 구문과 같은 효과를 가진다.|
|• Sorted Table|데이터는 인터널 테이블의 순서에 따라 추가된다. <br> Non-UNIQUE KEY 타입이라면, Duplicate Line은 같은 Key 위에 추가된다.|
|• Hashed Table|데이터는 Table Key의 Hash Index 순서에 따라 추가된다.|

**주의할점** <br>
&emsp; ***Standard Table은 Unique 한 속성으로 선언할 수 없기 때문에 중복된 key 값이 존재한다.***

## 2 Append 구문을 이용한 Table Line 추가
INSERT 구문은 Key와 Index를 이용해서 인터널 테이블에 데이터를 추가할 수 있지만 APPEND 구문은 <br> Index만 이용할 수 있다. 즉, Hashed Type의 인터널 테이블에서는 사용할 수 없다.
<br>
<Br>

### 2.1 한 라인 추가
한 라인을 삽입하려면
```ABAP
APPEND Line TO itab
```
APPEND를 한 후에는 시스템 변수 SY-TABIX 에 인터널 테이블에 추가된 라인의 Index 번호를 저장한다.

### 2.2 여러 라인 추가
INSERT 구문과 동일하게 인터널 테이블을 한 번에 다른 인터널 테이블로 추가 가능하다.
```ABAP
APPEND lines OF itab1 TO itab2.
```

이 구문을 활용하면 tiab1의 인덱스 n1 ~ n2 사이의 값을 itab2에 추가할 수 있다.
```ABAP
APPEND Lines OF itab1 [FROM n1] [TO n2] TO itab2.
```

### 2.3 인터널 테이블 타입에 따른 APPEND 효과
||||
|-------|---|---|
|• Standard Table|추가되는 데이터는 인터널 테이블의 마지막 위치에 추가된다. SORTED BY 옵션을 이용해서 Key 값 기준으로 DESCENDING 정렬을 하면서 추가할 수 있다.|
|• Sorted Table|데이터가 정렬된 상태로 인터널 테이블에 추가되도록 로직을 구성해야한다. 그렇지 않으면 Dump Error가 발생한다.|
|• Hashed Table|APPEND 구문을 사용할 수 없음.|

### 2.4 APPEND INITIAL LINE
인터널테이블을 빈공간에서 미리 생성한 후, 라인을 추가해보자
```ABAP
APPEND INITIAL LINE TO itab
~
APPEND wa TO itab.
```

## COLLECT 구문
COLLECT 구문을 이용해서 인터널 테이블의 숫자 타입 칼럼을 합산하는 기능을 수행한다.
```ABAP
COLLECT wa INTO itab.
```
<img src = "https://help.sap.com/saphelp_ewm900/helpdata/de/fc/eb36d5358411d1829f0000e829fbfe/bc070_03_image002.gif">