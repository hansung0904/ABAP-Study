# Index
## 8.1 Index란 무엇인가?
```ABAP
다음 SQL에서 HINTS 구문의 의미는 무엇일까요?

SELECT * FROM
INTO CORRESPONDING FIELDS of TABLE gt_emp 
FROM zemp
%_HINTS ORACLE 'INDEX(ZEMP, "ZEMP~Z01")'
```

예를 들면... <br>
위 SQL의 경우 옵티마이저는 여러 노선을 환승 하면서 가는 경우를 계산해서 결과를 도출한다. <br>
그래서 1호선만 타고 가라고 힌트를 주는 것. <br>

지하철 놋너의 예와 같이 인덱스를 이용해서 테이블 접근 속도를 더 빠르게 할 수 있다. <br>
프로그램을 개발할 때 데이터에 접근하기 위해 SQL을 사용하는데 <br>
SQL이 수행되면 해당 SQL의 성능 향상을 위해 인덱스가 사용된다. <br>
인덱스가 사용되는 SQL은 SELECT, UPDATE, DELETE 구문이 해당된다. <br>
인덱스는 데이터 접근을 빠르게 하려고 테이블과 별개의 물리적인 저장 공간에 목록(Index)을 작성해 놓은 건데 <br>
한마디로 정렬되어 있는 복사본 테이블이라고 정의하면 된다. <br>
정렬된 데이터는 테이블 데이터에 접근하는 시간을 절약할 수 있도록 도와준다. <br>

ABAP Dictionary 테이블에 추가한 인덱스는 물리적으로 오라클과 같은 데이터베이스에 인덱스를 생성하게 된다. <br>
즉, SAP 내부에 인덱스라는 오브젝트는 존재하지 않고, 단순히 ABAP Dictionary라는 통로를 통해 데이터베이스 인덱스를 대변하게 된다. <br>
T-CODE:SE11 (ABAP Dictionary)에서 ZEMP 테이블을 활성화 하는 순간 Primary key 필드 기준으로 '0'이라는 인덱스가 자동으로 생성되고, 데이터베이스에도 인덱스 케이블이 생성된다. <br>

***인덱스를 사용하는 것이 항상 효율적인가?*** <br>
&emsp;-> 테이블에서 추출해야 할 데이터 비율이 높아진다면 인덱스 목록 테이블에 접근한 후에 테이블에서 데이터를 가져오는데 중복 시간이 <br> &emsp;들어가게 된다. <br>&emsp;이러한 경우는 인덱스 테이블을 이용하지 않고, 바로 사원 테이블에 접근해서 처음부터 데이터를 차례대로 읽는 것이 더 효율적일 수 있다. <br>

ABAP Dictionary에는 Primary 인덱스와 Secondary 인덱스 두 가지가 존재하는데, Primary 인덱스는 테이블의 Key 필드로 구성되며 <br>
테이블 활성화 시 자동으로 생성된다. <br>
Primary 인덱스 이외에 Secondary 인덱스를 추가로 생성할 수 있다. <br>
Secondary 인덱스를 생성하면 테이블을 읽는 속도 자체는 증가하지만 데이터 추가 시에는 속도가 감소하게 되므로 신중하게 선택하도록 하자. <br>

특히 SAP는 통합 시스템으로 기존 레거시 시스템에 비해 대용량인 테이블들이 많이 존재하는데, 추가되는 Secondary 인덱스는 SELECT 구문은 WHERE 조건에 자주 쓰이며, 다른 테이블과 연관성이 많은 필드를 선택하는 것이 바람직하다. <br>

***단순히 개별 프로그램의 속도 문제로 인덱스를 생성하는 것은 지양하도록 하자.*** <br>
인덱스 이외에도 인터널 테이블의 정확한 사용과 JOIN과 같은 프로그램 튜닝만으로도 충분한 성능을 발휘 할 수 있다.

## 8.3 인덱스 사용 체크
인덱스를 활성화하였다면, 인덱스가 제대로 사용되는지 확인하여야 한다.

```ABAP
DATA : gt_itab TYPE TALE OF scarr.

SELECT * INTO CORRESPONDING FIELDS OF TABLE gt_itab
    FROM scarr  WHERE carrname = 'Air China'.
```

## 8.4 인덱스 Rebuild
인덱스 테입르 접근시 빠른 속도를 제공해 주는 최고의 방법이지만, 데이터베이스를 차지하는 공간이 많이 필요하기 때문에 **필요악**으로 분류 <br>
즉, 인덱스는 데이터베이스 공간을 소모할 뿐만 아니라 인덱스를 저장하는 시간이 필요하기 때문에 신중하게 사용하도록 하자. <br>

DELETE, UPDATE 구문이 자주 발생하는 테이블의 경우 쓸데없이 인덱스 공간이 비대해질 수 있다. <br>
이미 증가해버린 인덱스는 주기적인 Rebuild를 통해 회복할 수 있다. <br>
SAP 에서는 주로 Reorg라는 용어를 사용하며, BC가 OS에서 br*tools 라는 SAP 툴을 이용해서 주기적으로 Reorg를 수행하고 있다. <br>

테이블에 설정된 전체 인덱스는 한번에 조회가 가능한데 T-CODE:SE11에서 테이블을 조회한후에 <br>
[Utilities] -> [Database Object] -> [Display]를 선택하면 된다.
